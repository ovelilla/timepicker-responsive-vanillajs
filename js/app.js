(()=>{"use strict";class t{constructor(){if(this.constructor===t)throw new TypeError("Abstract class 'Form' cannot be instantiated directly.");window.addEventListener("load",this.handleLoad.bind(this))}get(){return this.field}createField(){const t=document.createElement("div");return t.classList.add("mio-field"),""!==this.input.value&&t.classList.add("active"),this.error&&t.classList.add("error"),t}createWrapper(){const t=document.createElement("div");return t.classList.add("mio-wrapper"),t}createLabel(){const t=document.createElement("label");return t.classList.add("mio-label"),t.textContent=this.label.text,t.htmlFor=this.label.for,t}createAdornment(t,e){return this.adornmentEl=document.createElement("div"),this.adornmentEl.classList.add("mio-adornment"),this.adornmentEl.classList.add(e),this.adornmentEl.appendChild(t),this.field.classList.add(`${e}-adornment`),this.adornmentEl}createMessage(){if(this.message)return this.messageEl=document.createElement("div"),this.messageEl.classList.add("mio-message"),this.error&&this.messageEl.classList.add("mio-error"),this.messageEl.textContent=this.message,this.messageEl}removeMessage(){this.messageEl&&(this.messageEl.remove(),this.error&&(this.field.classList.remove("error"),this.messageEl.classList.remove("mio-error")))}getValue(){return this.input.value}setValue(t){this.input.value=t,this.inputEl.value=t,this.field.classList.add("active"),this.removeMessage()}handleLoad(){this.field.querySelector("input:-webkit-autofill")&&this.field.classList.add("active")}handleBlur(){this.inputEl.value||this.field.classList.remove("active"),this.field.classList.remove("focus"),this.onBlur&&this.onBlur(this.inputEl.value)}handleFocus(){this.field.classList.add("active"),this.field.classList.add("focus")}handleInput(){this.manualErrorHandling||this.removeMessage(),this.onInput&&this.onInput(this.inputEl.value)}showError(t){this.error=!0,this.message=t,this.field.classList.add("error"),this.field.appendChild(this.createMessage())}removeError(){this.error=!1,this.message=null,this.field.classList.remove("error"),this.removeMessage()}showAdornment(t){this.adornment=t,this.wrapper.appendChild(this.createAdornment())}removeAdornment(){this.adornmentEl&&(this.adornment=null,this.adornmentEl.remove())}focus(){this.inputEl.focus()}blur(){this.inputEl.blur()}clear(){this.input.value="",this.inputEl.value="",this.field.classList.remove("active"),this.removeError()}}const e=t,s=(()=>{const t=[{name:"clock",paths:[{d:"M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z"},{d:"M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0z"}]}];return{get:e=>{const s=t.find((t=>t.name===e));return s?(t=>{const e=document.createElementNS("http://www.w3.org/2000/svg","svg");return e.setAttribute("width",`${t.width||16}`),e.setAttribute("height",`${t.height||16}`),e.setAttribute("fill","currentColor"),e.setAttribute("viewBox",`0 0 ${t.width||16} ${t.height||16}`),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),t.paths.forEach((t=>{const s=document.createElementNS("http://www.w3.org/2000/svg","path");t.fillRule&&s.setAttribute("fill-rule",t.fillRule),s.setAttribute("d",t.d),e.appendChild(s)})),e})(s):null}}})(),i=t=>t instanceof Date&&!isNaN(t),n=t=>/^([0-1][0-9]|2[0-3]):[0-5][0-9](:[0-5][0-9])?$/.test(t),h=(t,e)=>`${t.toString().padStart(2,"0")}:${e.toString().padStart(2,"0")}`,r=class extends e{constructor(t){super(t),Object.assign(this,t),this.isOpen=!1,this.create()}create(){this.field=this.createField(),this.wrapper=this.createWrapper(),this.labelEl=this.createLabel(),this.inputEl=this.createInput(),this.field.appendChild(this.wrapper),this.wrapper.appendChild(this.labelEl),this.wrapper.appendChild(this.inputEl),this.message&&!this.manualErrorHandling&&this.field.appendChild(this.createMessage());const t=new class{constructor(t){Object.assign(this,t),this.init()}init(){this.iconButton=this.create()}get(){return this.iconButton}create(){const t=document.createElement("button");switch(t.type=this.type??"button",t.ariaLabel=this.ariaLabel??"",t.classList.add("mio-icon-btn"),this.buttonSize){case"small":t.classList.add("btn-size-small");break;case"medium":t.classList.add("btn-size-medium");break;case"large":t.classList.add("btn-size-large");break;case"xl":t.classList.add("btn-size-xl");break;default:t.classList.add("btn-medium-small")}switch(this.svgSize){case"xs":t.classList.add("svg-size-xs");break;case"small":t.classList.add("svg-size-small");break;case"medium":default:t.classList.add("svg-size-medium");break;case"large":t.classList.add("svg-size-large");break;case"xl":t.classList.add("svg-size-xl")}return t.addEventListener("click",(t=>{t.stopPropagation(),this.onClick()})),t.appendChild(this.icon),t}}({type:"button",ariaLabel:"Icono calendario",buttonSize:"medium",svgSize:"medium",icon:s.get("clock"),onClick:()=>{this.inputEl.focus()}}).get();this.wrapper.appendChild(this.createAdornment(t,"right"))}createInput(){const t=document.createElement("input");return t.classList.add("mio-input"),t.type="text",t.name=this.input.name,t.id=this.input.id,t.value=this.formatValue(),t.readOnly=!0,this.input.placeholder&&(t.placeholder=this.input.placeholder),t.addEventListener("focus",this.handleFocus.bind(this)),t}handleFocus(){this.field.classList.add("active"),this.field.classList.add("focus"),this.onFocus&&this.onFocus()}handleBlur(){this.input.value||this.field.classList.remove("active"),this.field.classList.remove("focus"),this.onBlur&&this.onBlur()}setValue(t){this.input.value=t,this.inputEl.value=this.formatValue(),this.field.classList.add("active"),this.removeMessage()}formatValue(){let t=this.input.value;if(!t)return"";if(i(t)){const e=t.getHours(),s=t.getMinutes();return h(e,s)}if((t.includes("/")||t.includes("-"))&&(t=t.split(" ")[1]),!n(t))return"";if(t.includes(":")&&(t=t.split(":")),2===t.length||3===t.length){const e=Number(t[0]),s=Number(t[1]);return h(e,s)}return""}},a=async t=>new Promise((e=>{t.addEventListener("animationend",e,{once:!0})})),l={time:""},o={time:""},d=document.querySelector(".container"),c=document.createElement("form");c.classList.add("mio-form"),d.appendChild(c);const u=new class{constructor(t){Object.assign(this,t),this.init()}init(){this.inputTime=new r({label:this.label,input:this.input,error:this.error,message:this.message,onFocus:()=>{this.panel.open(),this.picker.render(),this.panel.render(this.picker.get())},onBlur:()=>{}}),this.panel=new class{constructor(t){Object.assign(this,t),this.isOpen=!1,this.isClose=!1}async open(){this.isOpen||(this.isOpen=!0,this.timepicker=this.create(),document.body.appendChild(this.timepicker),this.onOpen(),this.position(),this.timepicker.classList.add("in"),await a(this.timepicker))}render(t){this.timepicker.firstChild.appendChild(t)}create(){const t=document.createElement("div");t.classList.add("timepicker"),t.addEventListener("mousedown",this.checkClose.bind(this)),t.addEventListener("touchstart",this.checkClose.bind(this),{passive:!0}),t.addEventListener("click",(()=>{this.isClose&&this.close()})),this.resize=this.handleResize.bind(this),window.addEventListener("resize",this.resize);const e=document.createElement("div");return e.classList.add("content"),e.addEventListener("click",(t=>t.stopPropagation())),t.appendChild(e),t}position(){document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&document.body.classList.add("noscroll");const t=this.input.get(),e=t.getBoundingClientRect();innerWidth<768?this.timepicker.firstChild.removeAttribute("style"):(this.observer=new MutationObserver((()=>{e.top+this.timepicker.firstChild.offsetHeight+t.offsetHeight>window.innerHeight?this.timepicker.firstChild.style.top=e.top-this.timepicker.firstChild.offsetHeight-4+"px":this.timepicker.firstChild.style.top=`${e.top+t.offsetHeight+2}px`})),this.observer.observe(this.timepicker.firstChild,{attributes:!0}),this.timepicker.firstChild.style.left=`${e.left}px`,this.timepicker.firstChild.style.width=`${e.width}px`)}checkClose(t){t.target===this.timepicker&&(this.isClose=!0)}async close(){this.isOpen=!1,this.isClose=!1,document.body.classList.remove("noscroll"),this.timepicker.classList.add("out"),await a(this.timepicker),this.onClose(),this.destroy()}handleResize(){this.position()}destroy(){this.observer.disconnect(),window.removeEventListener("resize",this.resize),this.timepicker.remove()}}({input:this.inputTime,onOpen:()=>{this.inputTime.blur()},onClose:()=>{this.inputTime.handleBlur(),this.time.reset(),this.picker.destroy()}}),this.time=new class{constructor(t){Object.assign(this,t),this.init()}init(){this.hours=new class{constructor(t){Object.assign(this,t),this.hours=[],this.current=null,this.selected=null}init(){this.current=(new Date).getHours(),this.selected=(new Date).getHours(),this.set()}get(){return this.hours}set(){for(let t=0;t<24;t++){let e=(24+t+this.selected-4)%24,s="hidden";e===(24+this.selected-2)%24?s="prev-last":e===(24+this.selected-1)%24?s="prev":e===this.selected?s="current":e===(24+this.selected+1)%24?s="next":e===(24+this.selected+2)%24&&(s="next-last"),this.add({hour:e,type:s})}}next(){this.current=(24+this.current+1)%24}prev(){this.current=(24+this.current-1)%24}getSelected(){return this.selected}setSelected(){this.selected=this.current}setCurrent(){this.current=this.selected}add(t){this.hours=[...this.hours,t]}clear(){this.hours=[]}},this.minutes=new class{constructor(t){Object.assign(this,t),this.minutes=[],this.current=null,this.selected=null}init(){this.current=(new Date).getMinutes(),this.selected=(new Date).getMinutes(),this.set()}get(){return this.minutes}set(){for(let t=0;t<60;t++){let e=(60+t+this.selected-4)%60,s="hidden";e===(60+this.selected-2)%60?s="prev-last":e===(60+this.selected-1)%60?s="prev":e===this.selected?s="current":e===(60+this.selected+1)%60?s="next":e===(60+this.selected+2)%60&&(s="next-last"),this.add({minute:e,type:s})}}next(){this.current=(60+this.current+1)%60}prev(){this.current=(60+this.current-1)%60}getSelected(){return this.selected}setSelected(){this.selected=this.current}setCurrent(){this.current=this.selected}add(t){this.minutes=[...this.minutes,t]}clear(){this.minutes=[]}},this.checkValue()}checkValue(){return this.value?i(this.value)?(this.hours.current=this.value.getHours(),this.hours.selected=this.value.getHours(),this.hours.set(),this.minutes.current=this.value.getMinutes(),this.minutes.selected=this.value.getMinutes(),void this.minutes.set()):((this.value.includes("/")||this.value.includes("-"))&&(this.value=this.value.split(" ")[1]),n(this.value)?(this.value.includes(":")&&(this.value=this.value.split(":")),void(2===this.value.length||3===this.value.length?(this.hours.current=Number(this.value[0]),this.hours.selected=Number(this.value[0]),this.hours.set(),this.minutes.current=Number(this.value[1]),this.minutes.selected=Number(this.value[1]),this.minutes.set()):(this.hours.init(),this.minutes.init()))):(this.hours.init(),void this.minutes.init())):(this.hours.init(),void this.minutes.init())}set(){this.hours.set(),this.minutes.set()}setValue(t){this.value=t,this.clear(),this.checkValue()}setSelected(){this.hours.setSelected(),this.minutes.setSelected()}reset(){this.hours.setCurrent(),this.minutes.setCurrent()}clear(){this.hours.clear(),this.minutes.clear()}toString(){return h(this.hours.current,this.minutes.current)}}({value:this.input.value}),this.picker=new class{constructor(t){Object.assign(this,t)}init(){this.picker=this.create()}get(){return this.picker}render(){this.destroy(),this.init()}create(){const t=document.createElement("div");t.classList.add("picker");const e=document.createElement("div");e.classList.add("body"),t.appendChild(e),this.hourspicker=new class{constructor(t){Object.assign(this,t),this.isMove=!1,this.init()}init(){this.hourspicker=this.create()}get(){return this.hourspicker}create(){const t=document.createElement("div");t.classList.add("column","left"),t.addEventListener("mousedown",this.handleStart.bind(this)),t.addEventListener("touchstart",this.handleStart.bind(this),{passive:!0});const e=document.createElement("div");return e.classList.add("viewer"),t.appendChild(e),this.hoursEl=document.createElement("div"),this.hoursEl.classList.add("hours"),e.appendChild(this.hoursEl),this.time.hours.get().forEach((t=>{const e=document.createElement("div");e.classList.add("hour",t.type),e.textContent=t.hour.toString().padStart(2,"0"),this.hoursEl.appendChild(e)})),t}handleStart(t){this.isMove=!0,this.move=this.handleMove.bind(this),this.end=this.handleEnd.bind(this),document.addEventListener("mousemove",this.move),document.addEventListener("touchmove",this.move,{passive:!0}),document.addEventListener("mouseup",this.end),document.addEventListener("touchend",this.end,{passive:!0});const e=t.clientY??t.touches[0].clientY;this.startY=e,this.currentY=e,this.startTop=this.hoursEl.offsetTop,this.startTime=new Date,this.reset()}handleMove(t){if(!this.isMove)return;const e=t.clientY??t.touches[0].clientY;this.currentMoveY=e-this.currentY,this.totalMoveY=e-this.startY,this.paint()}handleEnd(){this.isMove&&(this.isMove=!1,this.hoursEl.style.top=`${this.startTop}px`,this.endTime=new Date,this.elapsedTime=this.endTime.getTime()-this.startTime.getTime(),this.pixelsPerTime=Math.abs(this.totalMoveY/this.elapsedTime),this.directionY=Math.sign(this.totalMoveY/this.elapsedTime),requestAnimationFrame(this.loop.bind(this)),document.removeEventListener("mousemove",this.move),document.removeEventListener("touchmove",this.move),document.removeEventListener("mouseup",this.end),document.removeEventListener("touchend",this.end))}loop(t){this.isMove||(this.oldTimeStamp||(this.oldTimeStamp=t),this.timePassed=t-this.oldTimeStamp,this.oldTimeStamp=t,this.currentMoveY+=this.pixelsPerTime*this.timePassed*this.directionY,this.reduction=this.reduction*this.reductionRatio,this.pixelsPerTime=this.pixelsPerTime-this.reduction,this.paint(),this.pixelsPerTime<0?this.hoursEl.style.top="-100px":requestAnimationFrame(this.loop.bind(this)))}paint(){this.hoursEl.style.top=`${this.startTop+this.currentMoveY}px`;const t=this.hoursEl.offsetTop;t<-130&&(this.hoursEl.appendChild(this.hoursEl.firstChild),this.time.hours.next()),t>-70&&(this.hoursEl.prepend(this.hoursEl.lastChild),this.time.hours.prev()),(t<-130||t>-70)&&(this.hoursEl.style.top="-100px",this.currentY=this.currentY+this.currentMoveY,this.currentMoveY=0,this.hoursEl.childNodes.forEach(((t,e)=>{t.classList.remove("prev-last","prev","current","next","next-last","hidden"),t.classList.add(this.time.hours.get()[e].type)})))}reset(){this.currentMoveY=0,this.totalMoveY=0,this.oldTimeStamp=null,this.reduction=.01,this.reductionRatio=1.02}destroy(){this.hourspicker&&this.hourspicker.remove()}}({time:this.time}),e.appendChild(this.hourspicker.get()),this.minutespicker=new class{constructor(t){Object.assign(this,t),this.isMove=!1,this.init()}init(){this.minutespicker=this.create()}get(){return this.minutespicker}render(){this.destroy(),this.init()}create(){const t=document.createElement("div");t.classList.add("column","right"),t.addEventListener("mousedown",this.handleStart.bind(this)),t.addEventListener("touchstart",this.handleStart.bind(this),{passive:!0});const e=document.createElement("div");return e.classList.add("viewer"),t.appendChild(e),this.minutesEl=document.createElement("div"),this.minutesEl.classList.add("minutes"),e.appendChild(this.minutesEl),this.time.minutes.get().forEach((t=>{const e=document.createElement("div");e.classList.add("minute",t.type),e.textContent=t.minute.toString().padStart(2,"0"),this.minutesEl.appendChild(e)})),t}handleStart(t){this.isMove=!0,this.move=this.handleMove.bind(this),this.end=this.handleEnd.bind(this),document.addEventListener("mousemove",this.move),document.addEventListener("touchmove",this.move,{passive:!0}),document.addEventListener("mouseup",this.end),document.addEventListener("touchend",this.end,{passive:!0});const e=t.clientY??t.touches[0].clientY;this.startY=e,this.currentY=e,this.startTop=this.minutesEl.offsetTop,this.startTime=new Date,this.reset()}handleMove(t){if(!this.isMove)return;const e=t.clientY??t.touches[0].clientY;this.currentMoveY=e-this.currentY,this.totalMoveY=e-this.startY,this.paint()}handleEnd(){this.isMove&&(this.isMove=!1,this.minutesEl.style.top=`${this.startTop}px`,this.endTime=new Date,this.elapsedTime=this.endTime.getTime()-this.startTime.getTime(),this.pixelsPerTime=Math.abs(this.totalMoveY/this.elapsedTime),this.directionY=Math.sign(this.totalMoveY/this.elapsedTime),requestAnimationFrame(this.loop.bind(this)),document.removeEventListener("mousemove",this.move),document.removeEventListener("touchmove",this.move),document.removeEventListener("mouseup",this.end),document.removeEventListener("touchend",this.end))}loop(t){this.isMove||(this.oldTimeStamp||(this.oldTimeStamp=t),this.timePassed=t-this.oldTimeStamp,this.oldTimeStamp=t,this.currentMoveY+=this.pixelsPerTime*this.timePassed*this.directionY,this.reduction=this.reduction*this.reductionRatio,this.pixelsPerTime=this.pixelsPerTime-this.reduction,this.paint(),this.pixelsPerTime<0?this.minutesEl.style.top="-100px":requestAnimationFrame(this.loop.bind(this)))}paint(){this.minutesEl.style.top=`${this.startTop+this.currentMoveY}px`;const t=this.minutesEl.offsetTop;t<-130&&(this.minutesEl.appendChild(this.minutesEl.firstChild),this.time.minutes.next()),t>-70&&(this.minutesEl.prepend(this.minutesEl.lastChild),this.time.minutes.prev()),(t<-130||t>-70)&&(this.minutesEl.style.top="-100px",this.currentY=this.currentY+this.currentMoveY,this.currentMoveY=0,this.minutesEl.childNodes.forEach(((t,e)=>{t.classList.remove("prev-last","prev","current","next","next-last","hidden"),t.classList.add(this.time.minutes.get()[e].type)})))}reset(){this.currentMoveY=0,this.totalMoveY=0,this.oldTimeStamp=null,this.reduction=.01,this.reductionRatio=1.02}destroy(){this.minutespicker&&this.minutespicker.remove()}}({time:this.time}),e.appendChild(this.minutespicker.get());const s=document.createElement("footer");return t.appendChild(s),this.cancelBtn=document.createElement("button"),this.cancelBtn.textContent="Cancelar",this.cancelBtn.ariaLabel="Cancelar",this.cancelBtn.addEventListener("click",(()=>{this.onCancel()})),s.appendChild(this.cancelBtn),this.acceptBtn=document.createElement("button"),this.acceptBtn.textContent="Aceptar",this.acceptBtn.ariaLabel="Aceptar",this.acceptBtn.addEventListener("click",(()=>{this.onAccept("hola")})),s.appendChild(this.acceptBtn),t}destroy(){this.picker&&this.picker.remove()}}({time:this.time,onCancel:()=>{this.panel.close()},onAccept:()=>{this.time.clear(),this.time.setSelected(),this.time.set(),this.panel.close(),this.inputTime.setValue(this.time.toString()),this.onSelect(this.time.toString())}})}get(){return this.inputTime.get()}getValue(){return this.inputTime.getValue()}setValue(t){this.inputTime.setValue(t),this.time.setValue(t)}destroy(){this.inputTime.destroy(),this.panel.destroy(),this.time.destroy(),this.picker.destroy()}}({label:{text:"Hora",for:"time"},input:{name:"time",id:"time",value:l.time,readOnly:!0,format:"long"},error:o.time.length>0,message:o.time,onSelect:t=>{l.time=t,o.time=""}});c.appendChild(u.get())})();